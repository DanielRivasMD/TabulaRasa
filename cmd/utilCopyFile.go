////////////////////////////////////////////////////////////////////////////////////////////////////

package cmd

////////////////////////////////////////////////////////////////////////////////////////////////////

import (
	"io"
	"log"
	"os"
)

////////////////////////////////////////////////////////////////////////////////////////////////////

// copy file
func copyFile(π paramsCopyReplace) {
	// clean prior copying
	if fileExist(π.dest) {
		os.Remove(π.dest)
	}

	// handle origin
	origFile, ε := os.Open(π.orig)
	if ε != nil {
		log.Fatal(ε)
	}
	defer origFile.Close()

	// handle destiny
	destFile, ε := os.Create(π.dest)
	if ε != nil {
		log.Fatal(ε)
	}
	defer destFile.Close()

	// copy file
	_, ε = io.Copy(destFile, origFile)
	if ε == nil {
		origInfo, ε := os.Stat(π.orig)
		if ε != nil {
			ε = os.Chmod(π.dest, origInfo.Mode())
		}
	}
	// replace
	if len(π.reps) > 0 {
		replace(π.dest, π.reps)
	}
}

////////////////////////////////////////////////////////////////////////////////////////////////////
